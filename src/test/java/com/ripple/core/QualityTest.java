package com.ripple.core;

import java.util.ArrayList;
import java.util.Collections;

import org.json.JSONObject;
import org.junit.Test;

import com.ripple.core.coretypes.Amount;
import com.ripple.core.coretypes.STObject;
import com.ripple.core.coretypes.hash.Hash256;
import com.ripple.core.fields.Field;
import com.ripple.core.types.known.sle.LedgerEntry;
import com.ripple.core.types.known.sle.entries.Offer;
import com.ripple.core.types.known.tx.Transaction;
import com.ripple.core.types.known.tx.result.AffectedNode;
import com.ripple.core.types.known.tx.result.TransactionMeta;

public class QualityTest {

	
	
	/*
	 * Our order consumes
	 * - OC belongs to us
	 * - OE belongs to others
	 * - If the order is fully consumed in the process then no order is created
	 * - If the order is partially consumed in the process then new order with remainder as quantity is created
	 * - Sequence always increases
	 * - OE with other account and FinalFields.TakerPays and TakerGets == 0 means their order is fully consumed, but we don't care
	 * - Counter : OE belonging to others
	 */
	@Test
	public void consume() throws Exception{
		String consumeOneHalf = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"A53C42A135396D1C9B7708E96977CB71454F4AE6C7900D0CF30B62AEC3FE5851\",\"ledger_index\":30854512,\"meta\":{\"AffectedNodes\":[{\"DeletedNode\":{\"FinalFields\":{\"ExchangeRate\":\"500A7AB7B21D6FCE\",\"Flags\":0,\"RootIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7AB7B21D6FCE\",\"TakerGetsCurrency\":\"0000000000000000000000000000000000000000\",\"TakerGetsIssuer\":\"0000000000000000000000000000000000000000\",\"TakerPaysCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerPaysIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7AB7B21D6FCE\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"25493.59330038829\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"25552.70487260873\"}},\"PreviousTxnID\":\"D3A84F7F810AC01AE88B7C120A01DB5694DE4775AE3DBE2613C849EBBA75C6F3\",\"PreviousTxnLgrSeq\":30854492}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"IndexPrevious\":\"0000000000001044\",\"Owner\":\"rLjDNH9g1AajRT2pxALZmwesd64p4x9XZJ\",\"RootIndex\":\"718BBB28EE36A3AC1DCBC75790357E2057015302DBA637DFD7851E820B5583BA\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"3B2BE34F74E8E10113F2D4C84053344F678D64E12D537D8D931D8981DF3AC7F4\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2517023578\",\"Flags\":0,\"OwnerCount\":9,\"Sequence\":5451},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2515023698\",\"Sequence\":5450},\"PreviousTxnID\":\"D3A84F7F810AC01AE88B7C120A01DB5694DE4775AE3DBE2613C849EBBA75C6F3\",\"PreviousTxnLgrSeq\":30854492}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rLjDNH9g1AajRT2pxALZmwesd64p4x9XZJ\",\"Balance\":\"1686510443008\",\"Flags\":0,\"OwnerCount\":2546,\"Sequence\":229780},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"7F28475BBAE8E0654C4D4C876DFBF7A3C40DEFEB6DF2F4C301F7F7F3514F255F\",\"PreviousFields\":{\"Balance\":\"1686512443008\",\"OwnerCount\":2547},\"PreviousTxnID\":\"9563022137D4F43F080FE59F74847D41C4C3222DB4FC0A70560AFDC33771712A\",\"PreviousTxnLgrSeq\":30854493}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rLjDNH9g1AajRT2pxALZmwesd64p4x9XZJ\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7AB7C76B2D09\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000001045\",\"Sequence\":229778,\"TakerGets\":\"7885940\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"232.6099563824587\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"83F71EE4B60B9016D25138FCE5D0D1E8DEF8C794940B42B53C8082516F1BEF40\",\"PreviousFields\":{\"TakerGets\":\"8442902\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"249.0385503771742\"}},\"PreviousTxnID\":\"5A2B58D139CDEADCD4B1F6DDE2CB766E5C9BECCD893AEB6747558D76E6586785\",\"PreviousTxnLgrSeq\":30854493}},{\"DeletedNode\":{\"FinalFields\":{\"Account\":\"rLjDNH9g1AajRT2pxALZmwesd64p4x9XZJ\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7AB7B21D6FCE\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000001045\",\"PreviousTxnID\":\"D3A84F7F810AC01AE88B7C120A01DB5694DE4775AE3DBE2613C849EBBA75C6F3\",\"PreviousTxnLgrSeq\":30854492,\"Sequence\":229774,\"TakerGets\":\"0\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"85794675649594FC8F8595FB5BB02342ABA3D5801DA543C13BCE89558BA3021C\",\"PreviousFields\":{\"TakerGets\":\"1443038\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"42.56499105563746\"}}}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-25536929.46912782\"},\"Flags\":2228224,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rLjDNH9g1AajRT2pxALZmwesd64p4x9XZJ\",\"value\":\"10000000000\"},\"HighNode\":\"0000000000000000\",\"HighQualityIn\":1000000000,\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"FB9399D7485EA21D73E649E9F821B8C10A1008285E32107B6F30F934723EB5C8\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-25536870.47554278\"}},\"PreviousTxnID\":\"D3A84F7F810AC01AE88B7C120A01DB5694DE4775AE3DBE2613C849EBBA75C6F3\",\"PreviousTxnLgrSeq\":30854492}}],\"TransactionIndex\":4,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"120\",\"Flags\":2147483648,\"LastLedgerSequence\":30854514,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5450,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"60\"},\"TakerPays\":\"2000000\",\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100EE1BC622B0768D2F01515AE8BC8157EA3EF361BB65C9E680C44CE7C87066CE4402207594042DD3E0FD7C8D0B59B84C96ECD0BF8780CB85B893FD5626F877CB3FB6F5\",\"date\":552025652,\"hash\":\"024C1B17CE1C35425550B6CC5676230B488C5680CADE21D226F8EA2D3594204D\",\"owner_funds\":\"25493.59330038829\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		String consumeOneHalfStillRemains1 = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"BD67C885A799D7CF8DDC5986C5D4EBED0BF628C9EF120F1463A77A5932BDE8D0\",\"ledger_index\":30855037,\"meta\":{\"AffectedNodes\":[{\"DeletedNode\":{\"FinalFields\":{\"ExchangeRate\":\"500A7B0266166000\",\"Flags\":0,\"RootIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7B0266166000\",\"TakerGetsCurrency\":\"0000000000000000000000000000000000000000\",\"TakerGetsIssuer\":\"0000000000000000000000000000000000000000\",\"TakerPaysCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerPaysIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7B0266166000\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"25434.47530038829\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"25493.59330038829\"}},\"PreviousTxnID\":\"024C1B17CE1C35425550B6CC5676230B488C5680CADE21D226F8EA2D3594204D\",\"PreviousTxnLgrSeq\":30854512}},{\"CreatedNode\":{\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"594A0491BDA278A3B4E112B046046EF41246B1F70BAD846F39E985897F99C8F3\",\"NewFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"BookDirectory\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C05D0F5BCC3CA\",\"OwnerNode\":\"0000000000000018\",\"Sequence\":5451,\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"59.1\"},\"TakerPays\":\"2000000\"}}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2519023566\",\"Flags\":0,\"OwnerCount\":10,\"Sequence\":5452},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2517023578\",\"OwnerCount\":9,\"Sequence\":5451},\"PreviousTxnID\":\"024C1B17CE1C35425550B6CC5676230B488C5680CADE21D226F8EA2D3594204D\",\"PreviousTxnLgrSeq\":30854512}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"4931.7762257212\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000001BC\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"value\":\"10000000000\"},\"LowNode\":\"0000000000000000\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"4872.7762257212\"}},\"PreviousTxnID\":\"5119074CF81B535F92AF56E2202343A5C2896668BFA616D611A303F8E19DEB9E\",\"PreviousTxnLgrSeq\":30757891}},{\"CreatedNode\":{\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C05D0F5BCC3CA\",\"NewFields\":{\"ExchangeRate\":\"590C05D0F5BCC3CA\",\"RootIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C05D0F5BCC3CA\",\"TakerGetsCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerGetsIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"}}},{\"DeletedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A7B0266166000\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000000000\",\"PreviousTxnID\":\"7D3DE72B6F0253FF415E6E0BE4B3A36A40B042795E2C9D34899F03DB0D2814F9\",\"PreviousTxnLgrSeq\":30855033,\"Sequence\":37,\"TakerGets\":\"0\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"D0F92EBE08ECA281A46EB111CFEB2A1B56D32FBEC89945A7847F8CE8FB44F00E\",\"PreviousFields\":{\"TakerGets\":\"2000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"59\"}}}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"IndexPrevious\":\"0000000000000006\",\"Owner\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"RootIndex\":\"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"D38B8330B1FF06370FEBC6A6DCF8F72A9E03E1E41E613D265C5C531BFE11FD0C\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Balance\":\"3429983993\",\"Flags\":0,\"OwnerCount\":2,\"Sequence\":38},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\"PreviousFields\":{\"Balance\":\"3431983993\",\"OwnerCount\":3},\"PreviousTxnID\":\"7D3DE72B6F0253FF415E6E0BE4B3A36A40B042795E2C9D34899F03DB0D2814F9\",\"PreviousTxnLgrSeq\":30855033}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"Owner\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"RootIndex\":\"EE65814EFC9DC9B26D4EE2C3554D7F1DF10BD11DA90C25344690F91AF0A2E9FE\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"EE65814EFC9DC9B26D4EE2C3554D7F1DF10BD11DA90C25344690F91AF0A2E9FE\"}}],\"TransactionIndex\":8,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30855039,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5451,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"118.2\"},\"TakerPays\":\"4000000\",\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100F4A42EDB93AB51DFAE34C9C499B5DE922E8F52796FBB214FC8A0520809A6E78A022065A9BDCCFFAC4485C7C44378BD3DB5F6CE4081FDF1F7324806C0546D6D00DE43\",\"date\":552027610,\"hash\":\"B3ECE9E61BEA532BC92DAC8D593D2F595C78D3A2DDC8861ED60685FB2D290F4D\",\"owner_funds\":\"25434.47530038829\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		String consumeOneHalfStillRemains2 = " {\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"5F362744C0BBA4CA4ED9C9AF55A4BDD0036F74A11311D8E8ED406947F15192AF\",\"ledger_index\":30866350,\"meta\":{\"AffectedNodes\":[{\"DeletedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000000000\",\"PreviousTxnID\":\"E9ACC38D67286EDE5D6E4A76C68A6CDCFC2C423CF856D2DF1CA7257FE46480A9\",\"PreviousTxnLgrSeq\":30866347,\"Sequence\":49,\"TakerGets\":\"0\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"0BEE9F84EF5B621C558B8E18FAA7161129145956C44BE17E02624DBDA3266782\",\"PreviousFields\":{\"TakerGets\":\"2000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"58.6\"}}}},{\"DeletedNode\":{\"FinalFields\":{\"ExchangeRate\":\"500A68D1C9312000\",\"Flags\":0,\"RootIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\",\"TakerGetsCurrency\":\"0000000000000000000000000000000000000000\",\"TakerGetsIssuer\":\"0000000000000000000000000000000000000000\",\"TakerPaysCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerPaysIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24256.81841590657\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24315.53561590657\"}},\"PreviousTxnID\":\"B7D883EC0A5C2F5E8DB36B224B02DE228EBFA41604E39EE0759E213E02B25050\",\"PreviousTxnLgrSeq\":30866329}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2559023398\",\"Flags\":0,\"OwnerCount\":10,\"Sequence\":5466},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2557023410\",\"OwnerCount\":9,\"Sequence\":5465},\"PreviousTxnID\":\"E423770B348A25B142DB99249E44B751208B515CAC85D8D26FF057052FB06DF1\",\"PreviousTxnLgrSeq\":30866343}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"5984.407355877956\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000001BC\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"value\":\"10000000000\"},\"LowNode\":\"0000000000000000\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"5925.807355877956\"}},\"PreviousTxnID\":\"B7D883EC0A5C2F5E8DB36B224B02DE228EBFA41604E39EE0759E213E02B25050\",\"PreviousTxnLgrSeq\":30866329}},{\"CreatedNode\":{\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA2\",\"NewFields\":{\"ExchangeRate\":\"590C2013D5C24EA2\",\"RootIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA2\",\"TakerGetsCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerGetsIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"}}},{\"CreatedNode\":{\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"CB812A1ABB9D41D653857DF779D4DF1B0C67D138E1ED747A19695A4EB6C1D762\",\"NewFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"BookDirectory\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA2\",\"OwnerNode\":\"0000000000000018\",\"Sequence\":5465,\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"87.9\"},\"TakerPays\":\"3000000\"}}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"IndexPrevious\":\"0000000000000006\",\"Owner\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"RootIndex\":\"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"D38B8330B1FF06370FEBC6A6DCF8F72A9E03E1E41E613D265C5C531BFE11FD0C\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Balance\":\"3393983741\",\"Flags\":0,\"OwnerCount\":2,\"Sequence\":50},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\"PreviousFields\":{\"Balance\":\"3395983741\",\"OwnerCount\":3},\"PreviousTxnID\":\"E9ACC38D67286EDE5D6E4A76C68A6CDCFC2C423CF856D2DF1CA7257FE46480A9\",\"PreviousTxnLgrSeq\":30866347}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"Owner\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"RootIndex\":\"EE65814EFC9DC9B26D4EE2C3554D7F1DF10BD11DA90C25344690F91AF0A2E9FE\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"EE65814EFC9DC9B26D4EE2C3554D7F1DF10BD11DA90C25344690F91AF0A2E9FE\"}}],\"TransactionIndex\":8,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30866352,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5465,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"146.5\"},\"TakerPays\":\"5000000\",\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100B44CEDC64776D29B329199B5976351E2B1C150761C4984F13260D6D4D21872890220260E89408A5B1C7EAA2EC4951EE0C26C900CE500EE49A043A41C0FEF31C41554\",\"date\":552067730,\"hash\":\"5ADB0FDB436D248AE6FD7192DC557AF89753F347F0C0EE2E42C4280DF291C5F7\",\"owner_funds\":\"24256.81841590657\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		System.out.println("consumeOneHalf- Ours all consumed 1");
		testOfferQuality(consumeOneHalf);
		System.out.println("consume - ours all consumed 2");
		String consumeOneHalf2 = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"C3C04E16DD32580668852A818FFC544B0AEF3C08EED981E60F949E18E74758D5\",\"ledger_index\":30866456,\"meta\":{\"AffectedNodes\":[{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24168.74261590657\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24198.10121590657\"}},\"PreviousTxnID\":\"21E64C8C2D106FA94C60CDE58F49A7EC9543558246777EABAFA1650F7CDA63C2\",\"PreviousTxnLgrSeq\":30866413}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000000000\",\"Sequence\":51,\"TakerGets\":\"1000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"29.3\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"47556CC80BECFE5978A442F2B111911C2094C6AD57242D137A9C7D9C10C45058\",\"PreviousFields\":{\"TakerGets\":\"2000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"58.6\"}},\"PreviousTxnID\":\"6E8AFBA36734F820E29EC67C3F254E180E6BF68B6DCC7F3AFE0C0ACCAD1F4F02\",\"PreviousTxnLgrSeq\":30866453}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2562023362\",\"Flags\":0,\"OwnerCount\":9,\"Sequence\":5469},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2561023374\",\"Sequence\":5468},\"PreviousTxnID\":\"21E64C8C2D106FA94C60CDE58F49A7EC9543558246777EABAFA1650F7CDA63C2\",\"PreviousTxnLgrSeq\":30866413}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"6072.307355877956\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000001BC\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"value\":\"10000000000\"},\"LowNode\":\"0000000000000000\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"6043.007355877956\"}},\"PreviousTxnID\":\"21E64C8C2D106FA94C60CDE58F49A7EC9543558246777EABAFA1650F7CDA63C2\",\"PreviousTxnLgrSeq\":30866413}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Balance\":\"3390983717\",\"Flags\":0,\"OwnerCount\":3,\"Sequence\":52},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\"PreviousFields\":{\"Balance\":\"3391983717\"},\"PreviousTxnID\":\"6E8AFBA36734F820E29EC67C3F254E180E6BF68B6DCC7F3AFE0C0ACCAD1F4F02\",\"PreviousTxnLgrSeq\":30866453}}],\"TransactionIndex\":1,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30866458,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5468,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"29.3\"},\"TakerPays\":\"1000000\",\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100B278AEEE88A2F52575EADF5B71475B8AB20AD080EDC25F3439C0238FD2C8EB0502200B0D1A1BA171D400DD75F9F45CB1AE476F3E2DC86F7832921DC216ABFC739093\",\"date\":552068092,\"hash\":\"99854B0A28130EE77EB4949AD3B90E9EA8CC207397F2892F8794B7BB10584D1E\",\"owner_funds\":\"24168.74261590657\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		testOfferQuality(consumeOneHalf2);
		System.out.println("consumeOneHalf - Ours still remains 1");
		testOfferQuality(consumeOneHalfStillRemains1);
		System.out.println("consumeOneHalf - Ours still remains 2");
		testOfferQuality(consumeOneHalfStillRemains2);
		System.out.println("consume fully match 1 ");
		String consumeFullyMatch1 = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"CCE62164682DE68112F0CE0E688B6A17E68EC77C21DD6B9472E275834C97E26A\",\"ledger_index\":30866413,\"meta\":{\"AffectedNodes\":[{\"DeletedNode\":{\"FinalFields\":{\"ExchangeRate\":\"500A68D1C9312000\",\"Flags\":0,\"RootIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\",\"TakerGetsCurrency\":\"0000000000000000000000000000000000000000\",\"TakerGetsIssuer\":\"0000000000000000000000000000000000000000\",\"TakerPaysCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerPaysIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24198.10121590657\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24256.81841590657\"}},\"PreviousTxnID\":\"5ADB0FDB436D248AE6FD7192DC557AF89753F347F0C0EE2E42C4280DF291C5F7\",\"PreviousTxnLgrSeq\":30866350}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2561023374\",\"Flags\":0,\"OwnerCount\":9,\"Sequence\":5468},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2559023386\",\"Sequence\":5467},\"PreviousTxnID\":\"1BE34C4C2B00DFE4A4FA3E5CAA33398018CFA13AB19AB9E945B64DF3928C8E0C\",\"PreviousTxnLgrSeq\":30866404}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"6043.007355877956\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000001BC\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"value\":\"10000000000\"},\"LowNode\":\"0000000000000000\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"5984.407355877956\"}},\"PreviousTxnID\":\"5ADB0FDB436D248AE6FD7192DC557AF89753F347F0C0EE2E42C4280DF291C5F7\",\"PreviousTxnLgrSeq\":30866350}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Balance\":\"3391983729\",\"Flags\":0,\"OwnerCount\":2,\"Sequence\":51},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\"PreviousFields\":{\"Balance\":\"3393983729\",\"OwnerCount\":3},\"PreviousTxnID\":\"77687E2805F496EF8F7CDD05AEB45AE1EF6860CED484B8A6B3D6392E92BC855A\",\"PreviousTxnLgrSeq\":30866410}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"Owner\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"RootIndex\":\"EE65814EFC9DC9B26D4EE2C3554D7F1DF10BD11DA90C25344690F91AF0A2E9FE\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"EE65814EFC9DC9B26D4EE2C3554D7F1DF10BD11DA90C25344690F91AF0A2E9FE\"}},{\"DeletedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D500A68D1C9312000\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000000000\",\"PreviousTxnID\":\"77687E2805F496EF8F7CDD05AEB45AE1EF6860CED484B8A6B3D6392E92BC855A\",\"PreviousTxnLgrSeq\":30866410,\"Sequence\":50,\"TakerGets\":\"0\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"F39D5B3EDE43CDA45620E1DBEA51B172E645AEFB0F8B5D2FFE2C566F6A1F1833\",\"PreviousFields\":{\"TakerGets\":\"2000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"58.6\"}}}}],\"TransactionIndex\":1,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30866416,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5467,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"58.6\"},\"TakerPays\":\"2000000\",\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100D4A91F74421D779A6588FE59C67D7F91E9E8BA6D6272CFADBADC6920E38206C602203D123FD05686FC86A6F1895577EDEDC713E61F96A4E4252583283462BDE60D86\",\"date\":552067942,\"hash\":\"21E64C8C2D106FA94C60CDE58F49A7EC9543558246777EABAFA1650F7CDA63C2\",\"owner_funds\":\"24198.10121590657\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		testOfferQuality(consumeFullyMatch1);
	}
	
	/*
	 * Our order is consumed
	 * - OC belongs to others
	 * - When consumed no new order is created
	 * - Sequence does not change if taken. Only our first OC adds the sequence. 
	 * - Counter : OE with our account
	 * - OE with our account and FinalFields.TakerPays and TakerGets == 0 means fully consumed
	 */
//	@Test
	public void consumed() throws Exception{
		System.out.println("partially consumed");
		String consumedHalf = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"23B2DF6090F92CF440EE8F3B9A57BC9855DBC7FF8D1EF3DA6ADEAC0690C3EF51\",\"ledger_index\":30856627,\"meta\":{\"AffectedNodes\":[{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"BookDirectory\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C03BC0A6F7FDE\",\"BookNode\":\"0000000000000000\",\"Flags\":0,\"OwnerNode\":\"0000000000000018\",\"Sequence\":5456,\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"88.71\"},\"TakerPays\":\"3000000\"},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"056871F43F37D6B924F7D35F4D2C0DF6D1E02A71E638EA5D454F5211FBC21420\",\"PreviousFields\":{\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"147.85\"},\"TakerPays\":\"5000000\"},\"PreviousTxnID\":\"677CA05F654AE8A07936A7205C6925746CB00A6B615105639C428857096963B3\",\"PreviousTxnLgrSeq\":30856614}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24903.01942038829\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24962.27770038829\"}},\"PreviousTxnID\":\"7FE4EDDC776B3ECC777444F5DF7CCB3AC7CC6C105B935BC72A63993DD9C86347\",\"PreviousTxnLgrSeq\":30856584}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2537023506\",\"Flags\":0,\"OwnerCount\":12,\"Sequence\":5457},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2535023506\"},\"PreviousTxnID\":\"677CA05F654AE8A07936A7205C6925746CB00A6B615105639C428857096963B3\",\"PreviousTxnLgrSeq\":30856614}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"5226.319164203065\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000001BC\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"value\":\"10000000000\"},\"LowNode\":\"0000000000000000\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"5167.179164203065\"}},\"PreviousTxnID\":\"7FE4EDDC776B3ECC777444F5DF7CCB3AC7CC6C105B935BC72A63993DD9C86347\",\"PreviousTxnLgrSeq\":30856584}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Balance\":\"3419983825\",\"Flags\":0,\"OwnerCount\":2,\"Sequence\":43},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\"PreviousFields\":{\"Balance\":\"3421983837\",\"Sequence\":42},\"PreviousTxnID\":\"7FE4EDDC776B3ECC777444F5DF7CCB3AC7CC6C105B935BC72A63993DD9C86347\",\"PreviousTxnLgrSeq\":30856584}}],\"TransactionIndex\":32,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Fee\":\"12\",\"Flags\":2148007936,\"LastLedgerSequence\":30856629,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":42,\"SigningPubKey\":\"03E8BBF8387DCDCE12F8B8F3CAC425D2587548E6510659E27F74E02EC7FE1DAE0E\",\"TakerGets\":\"2000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"59.14\"},\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3044022045BE95C9BC4AEDABF74AA052E72394819A1B9D7374E7FDD0F92C35F438290E45022064DF94A41EBCAFCCE246E27EE336A97D669CA1D26085D4E1B2D2940E394AD6D6\",\"date\":552033351,\"hash\":\"FC1649A761A589BAE43B22657B1A6A41942818E92EB7715C98A3B382DAED9879\",\"owner_funds\":\"3389983825\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		consumedHalf = " {\r\n   \"engine_result\": \"tesSUCCESS\",\r\n   \"engine_result_code\": 0,\r\n   \"engine_result_message\": \"The transaction was applied. Only final in a validated ledger.\",\r\n   \"ledger_hash\": \"D033EFA75F3E2F4ABE95BEB4703BA10180D9E6BDDC8774E607F51D2A780B04E8\",\r\n   \"ledger_index\": 30865654,\r\n   \"meta\": {\r\n     \"AffectedNodes\": [{\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"24579.52918038829\"\r\n           },\r\n           \"Flags\": 1114112,\r\n           \"HighLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0\"\r\n           },\r\n           \"HighNode\": \"0000000000000399\",\r\n           \"LowLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n             \"value\": \"100000\"\r\n           },\r\n           \"LowNode\": \"0000000000000001\"\r\n         },\r\n         \"LedgerEntryType\": \"RippleState\",\r\n         \"LedgerIndex\": \"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"24637.40470038829\"\r\n           }\r\n         },\r\n         \"PreviousTxnID\": \"87CCE5476E812BF52E84DC28F6BBF5039CEB09A9C109E66701A6815F7D76B5F3\",\r\n         \"PreviousTxnLgrSeq\": 30857020\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"Balance\": \"2548023470\",\r\n           \"Flags\": 0,\r\n           \"OwnerCount\": 10,\r\n           \"Sequence\": 5460\r\n         },\r\n         \"LedgerEntryType\": \"AccountRoot\",\r\n         \"LedgerIndex\": \"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": \"2546023470\"\r\n         },\r\n         \"PreviousTxnID\": \"72FB881031E415C24D676F524ADA3BA96ABDFBF15897AE56C96E93D34043C57E\",\r\n         \"PreviousTxnLgrSeq\": 30865648\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"BookDirectory\": \"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C4D384A272BF7\",\r\n           \"BookNode\": \"0000000000000000\",\r\n           \"Flags\": 0,\r\n           \"OwnerNode\": \"0000000000000018\",\r\n           \"Sequence\": 5459,\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"115.52\"\r\n           },\r\n           \"TakerPays\": \"4000000\"\r\n         },\r\n         \"LedgerEntryType\": \"Offer\",\r\n         \"LedgerIndex\": \"8A0FF6C3369FA060CF381614999FCDC2CE71545CFAB8551CDEDFC4A80AAD9378\",\r\n         \"PreviousFields\": {\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"173.28\"\r\n           },\r\n           \"TakerPays\": \"6000000\"\r\n         },\r\n         \"PreviousTxnID\": \"72FB881031E415C24D676F524ADA3BA96ABDFBF15897AE56C96E93D34043C57E\",\r\n         \"PreviousTxnLgrSeq\": 30865648\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"5459.34132648114\"\r\n           },\r\n           \"Flags\": 1114112,\r\n           \"HighLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0\"\r\n           },\r\n           \"HighNode\": \"00000000000001BC\",\r\n           \"LowLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\r\n             \"value\": \"10000000000\"\r\n           },\r\n           \"LowNode\": \"0000000000000000\"\r\n         },\r\n         \"LedgerEntryType\": \"RippleState\",\r\n         \"LedgerIndex\": \"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"5401.58132648114\"\r\n           }\r\n         },\r\n         \"PreviousTxnID\": \"691F3AAB618E4DB8AE0787326E4932A95970C50B555778C893F3077E0FBF44DF\",\r\n         \"PreviousTxnLgrSeq\": 30865630\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\r\n           \"Balance\": \"3411983789\",\r\n           \"Flags\": 0,\r\n           \"OwnerCount\": 2,\r\n           \"Sequence\": 46\r\n         },\r\n         \"LedgerEntryType\": \"AccountRoot\",\r\n         \"LedgerIndex\": \"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": \"3413983801\",\r\n           \"Sequence\": 45\r\n         },\r\n         \"PreviousTxnID\": \"691F3AAB618E4DB8AE0787326E4932A95970C50B555778C893F3077E0FBF44DF\",\r\n         \"PreviousTxnLgrSeq\": 30865630\r\n       }\r\n     }],\r\n     \"TransactionIndex\": 0,\r\n     \"TransactionResult\": \"tesSUCCESS\"\r\n   },\r\n   \"status\": \"closed\",\r\n   \"transaction\": {\r\n     \"Account\": \"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\r\n     \"Fee\": \"12\",\r\n     \"Flags\": 2148007936,\r\n     \"LastLedgerSequence\": 30865656,\r\n     \"Memos\": [{\r\n       \"Memo\": {\r\n         \"MemoData\": \"726D2D312E322E33\",\r\n         \"MemoType\": \"636C69656E74\"\r\n       }\r\n     }],\r\n     \"Sequence\": 45,\r\n     \"SigningPubKey\": \"03E8BBF8387DCDCE12F8B8F3CAC425D2587548E6510659E27F74E02EC7FE1DAE0E\",\r\n     \"TakerGets\": \"2000000\",\r\n     \"TakerPays\": {\r\n       \"currency\": \"JPY\",\r\n       \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n       \"value\": \"57.4\"\r\n     },\r\n     \"TransactionType\": \"OfferCreate\",\r\n     \"TxnSignature\": \"3045022100DE76C78BF856494C88AE57919168ABC7E901541DE5D0A7654FAF66B8949AFFC902204FDFD2727CE3D314C8999BEA95763238B098411F14A7EE1D61D78D55BEB44146\",\r\n     \"date\": 552065342,\r\n     \"hash\": \"101271F524C97A5EA68DF34CABB6703143367A1BA05754E5FB85A4D63DA0AFE4\",\r\n     \"owner_funds\": \"3381983789\"\r\n   },\r\n   \"type\": \"transaction\",\r\n   \"validated\": true\r\n }";
		
		String consumedHalfAndFull1 = "{\r\n  \"engine_result\": \"tesSUCCESS\",\r\n  \"engine_result_code\": 0,\r\n  \"engine_result_message\": \"The transaction was applied. Only final in a validated ledger.\",\r\n  \"ledger_hash\": \"04EF2B9C096CD323A3B102A2C88B71EC643B9B156B9B64CD72ECBBAB78478611\",\r\n  \"ledger_index\": 30865952,\r\n  \"meta\": {\r\n    \"AffectedNodes\": [{\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"24562.81142125649\"\r\n          },\r\n          \"Flags\": 1114112,\r\n          \"HighLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"HighNode\": \"0000000000000399\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n            \"value\": \"100000\"\r\n          },\r\n          \"LowNode\": \"0000000000000001\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"24579.52918038829\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"101271F524C97A5EA68DF34CABB6703143367A1BA05754E5FB85A4D63DA0AFE4\",\r\n        \"PreviousTxnLgrSeq\": 30865654\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n          \"BookDirectory\": \"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C25623355ACDA\",\r\n          \"BookNode\": \"0000000000000000\",\r\n          \"Flags\": 0,\r\n          \"OwnerNode\": \"0000000000000018\",\r\n          \"Sequence\": 5461,\r\n          \"TakerGets\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"100.2822408681903\"\r\n          },\r\n          \"TakerPays\": \"3428452\"\r\n        },\r\n        \"LedgerEntryType\": \"Offer\",\r\n        \"LedgerIndex\": \"3BF312372EF6EB3F72D0562402005945F88E66437DEAE259545C789258DC8389\",\r\n        \"PreviousFields\": {\r\n          \"TakerGets\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"117\"\r\n          },\r\n          \"TakerPays\": \"4000000\"\r\n        },\r\n        \"PreviousTxnID\": \"C03EEBCA6A585271DD03A8ED4E59F067AADB36C32978F17589CE10412A278246\",\r\n        \"PreviousTxnLgrSeq\": 30865948\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"rUc9qqJpdGrEJ1UiEHiMz2TCB3mmvr1P8F\",\r\n          \"Balance\": \"31777122531\",\r\n          \"Flags\": 0,\r\n          \"OwnerCount\": 49,\r\n          \"Sequence\": 837\r\n        },\r\n        \"LedgerEntryType\": \"AccountRoot\",\r\n        \"LedgerIndex\": \"418E2A54C93ADD8D7EEBE5EDB240C4BBB98A919B8AF67756A2D52D5C461C37B0\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": \"31777696708\",\r\n          \"OwnerCount\": 50\r\n        },\r\n        \"PreviousTxnID\": \"E1875B0DB074D4B85A2D62384A25E174086C056527290DCB6DF08B9460D21F9F\",\r\n        \"PreviousTxnLgrSeq\": 30865938\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"r9KG7Du7aFmABzMvDnwuvPaEoMu4Eurwok\",\r\n          \"Balance\": \"371546507978\",\r\n          \"Flags\": 0,\r\n          \"OwnerCount\": 6,\r\n          \"Sequence\": 48945\r\n        },\r\n        \"LedgerEntryType\": \"AccountRoot\",\r\n        \"LedgerIndex\": \"5A667CB5FBAB4143EDEFBD6EDDD4B6D19C905209C8EE16486D5D7CD6CB083E78\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": \"371546505359\",\r\n          \"Sequence\": 48944\r\n        },\r\n        \"PreviousTxnID\": \"39A1FDDAA00766559DE1B786A99542DD19F3E42CF851A041B6C605197BF09DF0\",\r\n        \"PreviousTxnLgrSeq\": 30865800\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"-207793.3474527851\"\r\n          },\r\n          \"Flags\": 2228224,\r\n          \"HighLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rUc9qqJpdGrEJ1UiEHiMz2TCB3mmvr1P8F\",\r\n            \"value\": \"10000000000\"\r\n          },\r\n          \"HighNode\": \"0000000000000000\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"LowNode\": \"00000000000001B7\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"5F894CD5A7BE52AE1A1A74075313B891598C6FA41D820B84E2EE01457EAC5E8E\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"-207776.663062434\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"E1875B0DB074D4B85A2D62384A25E174086C056527290DCB6DF08B9460D21F9F\",\r\n        \"PreviousTxnLgrSeq\": 30865938\r\n      }\r\n    }, {\r\n      \"DeletedNode\": {\r\n        \"FinalFields\": {\r\n          \"ExchangeRate\": \"4B038D7EA4C68000\",\r\n          \"Flags\": 0,\r\n          \"RootIndex\": \"6CBBA821BB26420284E9C91F4E8B5D66FA66DDB55163D1F54B038D7EA4C68000\",\r\n          \"TakerGetsCurrency\": \"0000000000000000000000000000000000000000\",\r\n          \"TakerGetsIssuer\": \"0000000000000000000000000000000000000000\",\r\n          \"TakerPaysCurrency\": \"0000000000000000000000004254430000000000\",\r\n          \"TakerPaysIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"\r\n        },\r\n        \"LedgerEntryType\": \"DirectoryNode\",\r\n        \"LedgerIndex\": \"6CBBA821BB26420284E9C91F4E8B5D66FA66DDB55163D1F54B038D7EA4C68000\"\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n          \"Balance\": \"2548594994\",\r\n          \"Flags\": 0,\r\n          \"OwnerCount\": 10,\r\n          \"Sequence\": 5462\r\n        },\r\n        \"LedgerEntryType\": \"AccountRoot\",\r\n        \"LedgerIndex\": \"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": \"2548023446\"\r\n        },\r\n        \"PreviousTxnID\": \"C03EEBCA6A585271DD03A8ED4E59F067AADB36C32978F17589CE10412A278246\",\r\n        \"PreviousTxnLgrSeq\": 30865948\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"GCB\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"9999725342.910839\"\r\n          },\r\n          \"Flags\": 3211264,\r\n          \"HighLimit\": {\r\n            \"currency\": \"GCB\",\r\n            \"issuer\": \"rHaans8PtgwbacHvXAL3u6TG28gTAtCwr8\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"HighNode\": \"0000000000000000\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"GCB\",\r\n            \"issuer\": \"r9KG7Du7aFmABzMvDnwuvPaEoMu4Eurwok\",\r\n            \"value\": \"10000000000\"\r\n          },\r\n          \"LowNode\": \"0000000000000000\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"A2B41EE7818A5756B6A2276BDBB3CE0ED3A3B350787FD6B76E5EA1354A8F20D2\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"GCB\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"9999725343.485016\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"730859F8ED581DAF22747A3936132E9DCEE89A68027C0EF606ECF81ECFE7F298\",\r\n        \"PreviousTxnLgrSeq\": 30865742\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"rUc9qqJpdGrEJ1UiEHiMz2TCB3mmvr1P8F\",\r\n          \"BookDirectory\": \"A5B25D747DFDAFA1FC9B7360BFF856CF39FAE55C9E92C8C35A0A4D88DDD94000\",\r\n          \"BookNode\": \"0000000000000000\",\r\n          \"Flags\": 131072,\r\n          \"OwnerNode\": \"0000000000000005\",\r\n          \"Sequence\": 817,\r\n          \"TakerGets\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0.06984000000000007\"\r\n          },\r\n          \"TakerPays\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"20253.60000000001\"\r\n          }\r\n        },\r\n        \"LedgerEntryType\": \"Offer\",\r\n        \"LedgerIndex\": \"B86255BAC491DA02534035A15FA76056298BF9BDBB049A1BED8242062B6556A7\",\r\n        \"PreviousFields\": {\r\n          \"TakerGets\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0.06989753238052113\"\r\n          },\r\n          \"TakerPays\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"20270.28439035111\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"DA0B582AC7C8E6802FC2960F16E5C745146EE0EB5373C4E76E64861C7E76DBCA\",\r\n        \"PreviousTxnLgrSeq\": 30865716\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"r9KG7Du7aFmABzMvDnwuvPaEoMu4Eurwok\",\r\n          \"BookDirectory\": \"E6E8A9842EA2ED1FD5D0599343692CE1EBF977AEA751B7DC5B038D7EA4C68000\",\r\n          \"BookNode\": \"0000000000000000\",\r\n          \"Flags\": 65536,\r\n          \"OwnerNode\": \"0000000000000000\",\r\n          \"Sequence\": 39018,\r\n          \"TakerGets\": {\r\n            \"currency\": \"GCB\",\r\n            \"issuer\": \"rHaans8PtgwbacHvXAL3u6TG28gTAtCwr8\",\r\n            \"value\": \"9999725342.910839\"\r\n          },\r\n          \"TakerPays\": \"9999725342910839\"\r\n        },\r\n        \"LedgerEntryType\": \"Offer\",\r\n        \"LedgerIndex\": \"C939B9B2C5803DD6D89B792E72470F79CBE9F9E999691789E0B68C3808BDDD8E\",\r\n        \"PreviousFields\": {\r\n          \"TakerGets\": {\r\n            \"currency\": \"GCB\",\r\n            \"issuer\": \"rHaans8PtgwbacHvXAL3u6TG28gTAtCwr8\",\r\n            \"value\": \"9999725343.485016\"\r\n          },\r\n          \"TakerPays\": \"9999725343485016\"\r\n        },\r\n        \"PreviousTxnID\": \"730859F8ED581DAF22747A3936132E9DCEE89A68027C0EF606ECF81ECFE7F298\",\r\n        \"PreviousTxnLgrSeq\": 30865742\r\n      }\r\n    }, {\r\n      \"DeletedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"rUc9qqJpdGrEJ1UiEHiMz2TCB3mmvr1P8F\",\r\n          \"BookDirectory\": \"6CBBA821BB26420284E9C91F4E8B5D66FA66DDB55163D1F54B038D7EA4C68000\",\r\n          \"BookNode\": \"0000000000000000\",\r\n          \"Flags\": 131072,\r\n          \"OwnerNode\": \"0000000000000004\",\r\n          \"PreviousTxnID\": \"D5617444A60AC738C2A6607C4FE754986D0BCF5443835AE3E1A7B25A293ECB8B\",\r\n          \"PreviousTxnLgrSeq\": 30865716,\r\n          \"Sequence\": 806,\r\n          \"TakerGets\": \"0\",\r\n          \"TakerPays\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          }\r\n        },\r\n        \"LedgerEntryType\": \"Offer\",\r\n        \"LedgerIndex\": \"D56342176D5062463F75E5DD7E5DA1DF9C97A8F0A7FB3E353B167475C603078A\",\r\n        \"PreviousFields\": {\r\n          \"TakerGets\": \"574177\",\r\n          \"TakerPays\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0.0000574175454302\"\r\n          }\r\n        }\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"-4.884970810055803\"\r\n          },\r\n          \"Flags\": 2228224,\r\n          \"HighLimit\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rUc9qqJpdGrEJ1UiEHiMz2TCB3mmvr1P8F\",\r\n            \"value\": \"10000000000\"\r\n          },\r\n          \"HighNode\": \"0000000000000000\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"LowNode\": \"0000000000000209\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"D9B53EADD8FDF624071138FEAAA38F603A0BF6C7D8B474096F32687731ACBDD6\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"BTC\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"-4.884970924890894\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"D5617444A60AC738C2A6607C4FE754986D0BCF5443835AE3E1A7B25A293ECB8B\",\r\n        \"PreviousTxnLgrSeq\": 30865716\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Flags\": 0,\r\n          \"IndexNext\": \"0000000000000005\",\r\n          \"IndexPrevious\": \"0000000000000003\",\r\n          \"Owner\": \"rUc9qqJpdGrEJ1UiEHiMz2TCB3mmvr1P8F\",\r\n          \"RootIndex\": \"B44FEA42527C9C3F380F1838D2C29BB40FC67B906B65823F0028B3CF1BB6D838\"\r\n        },\r\n        \"LedgerEntryType\": \"DirectoryNode\",\r\n        \"LedgerIndex\": \"FFDD7CA97B030C097A1AABD446820DB0F00697E88DA8C09E2AEAC11483C3A9B0\"\r\n      }\r\n    }],\r\n    \"DeliveredAmount\": {\r\n      \"currency\": \"GCB\",\r\n      \"issuer\": \"rHaans8PtgwbacHvXAL3u6TG28gTAtCwr8\",\r\n      \"value\": \"0.574177\"\r\n    },\r\n    \"TransactionIndex\": 2,\r\n    \"TransactionResult\": \"tesSUCCESS\"\r\n  },\r\n  \"status\": \"closed\",\r\n  \"transaction\": {\r\n    \"Account\": \"r9KG7Du7aFmABzMvDnwuvPaEoMu4Eurwok\",\r\n    \"Amount\": {\r\n      \"currency\": \"GCB\",\r\n      \"issuer\": \"rHaans8PtgwbacHvXAL3u6TG28gTAtCwr8\",\r\n      \"value\": \"10000\"\r\n    },\r\n    \"Destination\": \"rHaans8PtgwbacHvXAL3u6TG28gTAtCwr8\",\r\n    \"Fee\": \"10\",\r\n    \"Flags\": 458752,\r\n    \"Paths\": [\r\n      [{\r\n        \"currency\": \"JPY\",\r\n        \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n        \"type\": 48,\r\n        \"type_hex\": \"0000000000000030\"\r\n      }, {\r\n        \"account\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n        \"type\": 1,\r\n        \"type_hex\": \"0000000000000001\"\r\n      }, {\r\n        \"currency\": \"BTC\",\r\n        \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n        \"type\": 48,\r\n        \"type_hex\": \"0000000000000030\"\r\n      }, {\r\n        \"account\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n        \"type\": 1,\r\n        \"type_hex\": \"0000000000000001\"\r\n      }, {\r\n        \"currency\": \"XRP\",\r\n        \"type\": 16,\r\n        \"type_hex\": \"0000000000000010\"\r\n      }],\r\n      [{\r\n        \"currency\": \"CNY\",\r\n        \"issuer\": \"rKiCet8SdvWxPXnAgYarFUXMh1zCPz432Y\",\r\n        \"type\": 48,\r\n        \"type_hex\": \"0000000000000030\"\r\n      }, {\r\n        \"currency\": \"XLM\",\r\n        \"issuer\": \"rKiCet8SdvWxPXnAgYarFUXMh1zCPz432Y\",\r\n        \"type\": 48,\r\n        \"type_hex\": \"0000000000000030\"\r\n      }, {\r\n        \"account\": \"rKiCet8SdvWxPXnAgYarFUXMh1zCPz432Y\",\r\n        \"type\": 1,\r\n        \"type_hex\": \"0000000000000001\"\r\n      }, {\r\n        \"currency\": \"BTC\",\r\n        \"issuer\": \"rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59B\",\r\n        \"type\": 48,\r\n        \"type_hex\": \"0000000000000030\"\r\n      }, {\r\n        \"account\": \"rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59B\",\r\n        \"type\": 1,\r\n        \"type_hex\": \"0000000000000001\"\r\n      }, {\r\n        \"currency\": \"XRP\",\r\n        \"type\": 16,\r\n        \"type_hex\": \"0000000000000010\"\r\n      }]\r\n    ],\r\n    \"SendMax\": \"9999990000\",\r\n    \"Sequence\": 48944,\r\n    \"SigningPubKey\": \"03580C9EBB7EEF804E020161E07DC8B904BDB718650F2DCF983E8638AB0EDFA415\",\r\n    \"TransactionType\": \"Payment\",\r\n    \"TxnSignature\": \"30460221009285C513166F291B012A28F62669365302DE1D6682632F36811B8785E5F44FC0022100DE33541D5EB6A0839AFEE741051B163A31A53A746B6B7253D6834696829B4768\",\r\n    \"date\": 552066390,\r\n    \"hash\": \"A0DC5ECFCB27E60955F4BC011F5A3BF3EA35693AA6F45723642DE025D8DED9C6\"\r\n  },\r\n  \"type\": \"transaction\",\r\n  \"validated\": true\r\n}";
		String consumedHalfAndFull1b = " {\r\n   \"engine_result\": \"tesSUCCESS\",\r\n   \"engine_result_code\": 0,\r\n   \"engine_result_message\": \"The transaction was applied. Only final in a validated ledger.\",\r\n   \"ledger_hash\": \"9022FC218C76ECAAB19BD196AE9C6B4D2696218B4E0D84C4E344F73D8CE9785C\",\r\n   \"ledger_index\": 30865954,\r\n   \"meta\": {\r\n     \"AffectedNodes\": [{\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"24462.32861590657\"\r\n           },\r\n           \"Flags\": 1114112,\r\n           \"HighLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0\"\r\n           },\r\n           \"HighNode\": \"0000000000000399\",\r\n           \"LowLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n             \"value\": \"100000\"\r\n           },\r\n           \"LowNode\": \"0000000000000001\"\r\n         },\r\n         \"LedgerEntryType\": \"RippleState\",\r\n         \"LedgerIndex\": \"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"24562.81142125649\"\r\n           }\r\n         },\r\n         \"PreviousTxnID\": \"A0DC5ECFCB27E60955F4BC011F5A3BF3EA35693AA6F45723642DE025D8DED9C6\",\r\n         \"PreviousTxnLgrSeq\": 30865952\r\n       }\r\n     }, {\r\n       \"DeletedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"BookDirectory\": \"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C25623355ACDA\",\r\n           \"BookNode\": \"0000000000000000\",\r\n           \"Flags\": 0,\r\n           \"OwnerNode\": \"0000000000000018\",\r\n           \"PreviousTxnID\": \"A0DC5ECFCB27E60955F4BC011F5A3BF3EA35693AA6F45723642DE025D8DED9C6\",\r\n           \"PreviousTxnLgrSeq\": 30865952,\r\n           \"Sequence\": 5461,\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0\"\r\n           },\r\n           \"TakerPays\": \"0\"\r\n         },\r\n         \"LedgerEntryType\": \"Offer\",\r\n         \"LedgerIndex\": \"3BF312372EF6EB3F72D0562402005945F88E66437DEAE259545C789258DC8389\",\r\n         \"PreviousFields\": {\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"100.2822408681903\"\r\n           },\r\n           \"TakerPays\": \"3428452\"\r\n         }\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"1795560.195939358\"\r\n           },\r\n           \"Flags\": 1114112,\r\n           \"HighLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0\"\r\n           },\r\n           \"HighNode\": \"0000000000000209\",\r\n           \"LowLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rn75cXegVgS1X7e9B2kzM3Q7rwfRkzXmTm\",\r\n             \"value\": \"10000000000\"\r\n           },\r\n           \"LowNode\": \"0000000000000000\"\r\n         },\r\n         \"LedgerEntryType\": \"RippleState\",\r\n         \"LedgerIndex\": \"3FB9C56D862461297C259416800AFE5A9E47074866EDEB0482340DB7F822461A\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"1795635.435319361\"\r\n           }\r\n         },\r\n         \"PreviousTxnID\": \"8F06AB70C3A842C163E67FADCC9C6D6961795F593D32F49E014F442153FCCD51\",\r\n         \"PreviousTxnLgrSeq\": 30865940\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"rn75cXegVgS1X7e9B2kzM3Q7rwfRkzXmTm\",\r\n           \"BookDirectory\": \"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2AB537CE5EAF\",\r\n           \"BookNode\": \"0000000000000000\",\r\n           \"Flags\": 0,\r\n           \"OwnerNode\": \"0000000000000000\",\r\n           \"Sequence\": 347,\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"1794576.52876\"\r\n           },\r\n           \"TakerPays\": \"61458100300\"\r\n         },\r\n         \"LedgerEntryType\": \"Offer\",\r\n         \"LedgerIndex\": \"52F018B67940DCCF1B7D1C557AA00DBF85311E2C3AAFFD165710A80D3145E7B6\",\r\n         \"PreviousFields\": {\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"1794651.6179616\"\r\n           },\r\n           \"TakerPays\": \"61460671848\"\r\n         },\r\n         \"PreviousTxnID\": \"8F06AB70C3A842C163E67FADCC9C6D6961795F593D32F49E014F442153FCCD51\",\r\n         \"PreviousTxnLgrSeq\": 30865940\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"rn75cXegVgS1X7e9B2kzM3Q7rwfRkzXmTm\",\r\n           \"Balance\": \"294599241449\",\r\n           \"Flags\": 0,\r\n           \"OwnerCount\": 5,\r\n           \"Sequence\": 348\r\n         },\r\n         \"LedgerEntryType\": \"AccountRoot\",\r\n         \"LedgerIndex\": \"690765BB002DD7977DD162D9CE11FB704D111E1C027BB9D77B31E56B43A00416\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": \"294596669901\"\r\n         },\r\n         \"PreviousTxnID\": \"8F06AB70C3A842C163E67FADCC9C6D6961795F593D32F49E014F442153FCCD51\",\r\n         \"PreviousTxnLgrSeq\": 30865940\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"Balance\": \"2552023446\",\r\n           \"Flags\": 0,\r\n           \"OwnerCount\": 9,\r\n           \"Sequence\": 5462\r\n         },\r\n         \"LedgerEntryType\": \"AccountRoot\",\r\n         \"LedgerIndex\": \"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": \"2548594994\",\r\n           \"OwnerCount\": 10\r\n         },\r\n         \"PreviousTxnID\": \"A0DC5ECFCB27E60955F4BC011F5A3BF3EA35693AA6F45723642DE025D8DED9C6\",\r\n         \"PreviousTxnLgrSeq\": 30865952\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"5779.307355877956\"\r\n           },\r\n           \"Flags\": 1114112,\r\n           \"HighLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0\"\r\n           },\r\n           \"HighNode\": \"00000000000001BC\",\r\n           \"LowLimit\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\r\n             \"value\": \"10000000000\"\r\n           },\r\n           \"LowNode\": \"0000000000000000\"\r\n         },\r\n         \"LedgerEntryType\": \"RippleState\",\r\n         \"LedgerIndex\": \"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n             \"value\": \"5603.935913409766\"\r\n           }\r\n         },\r\n         \"PreviousTxnID\": \"F2500448CE47E43AF02B4C38BB3C232506B2662DDABBF59D5B5652F9ED17BD30\",\r\n         \"PreviousTxnLgrSeq\": 30865662\r\n       }\r\n     }, {\r\n       \"DeletedNode\": {\r\n         \"FinalFields\": {\r\n           \"ExchangeRate\": \"590C25623355ACDA\",\r\n           \"Flags\": 0,\r\n           \"RootIndex\": \"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C25623355ACDA\",\r\n           \"TakerGetsCurrency\": \"0000000000000000000000004A50590000000000\",\r\n           \"TakerGetsIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\",\r\n           \"TakerPaysCurrency\": \"0000000000000000000000000000000000000000\",\r\n           \"TakerPaysIssuer\": \"0000000000000000000000000000000000000000\"\r\n         },\r\n         \"LedgerEntryType\": \"DirectoryNode\",\r\n         \"LedgerIndex\": \"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C25623355ACDA\"\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Flags\": 0,\r\n           \"IndexPrevious\": \"0000000000000006\",\r\n           \"Owner\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"RootIndex\": \"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"\r\n         },\r\n         \"LedgerEntryType\": \"DirectoryNode\",\r\n         \"LedgerIndex\": \"D38B8330B1FF06370FEBC6A6DCF8F72A9E03E1E41E613D265C5C531BFE11FD0C\"\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\r\n           \"Balance\": \"3400983765\",\r\n           \"Flags\": 0,\r\n           \"OwnerCount\": 2,\r\n           \"Sequence\": 48\r\n         },\r\n         \"LedgerEntryType\": \"AccountRoot\",\r\n         \"LedgerIndex\": \"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": \"3406983777\",\r\n           \"Sequence\": 47\r\n         },\r\n         \"PreviousTxnID\": \"F2500448CE47E43AF02B4C38BB3C232506B2662DDABBF59D5B5652F9ED17BD30\",\r\n         \"PreviousTxnLgrSeq\": 30865662\r\n       }\r\n     }],\r\n     \"TransactionIndex\": 7,\r\n     \"TransactionResult\": \"tesSUCCESS\"\r\n   },\r\n   \"status\": \"closed\",\r\n   \"transaction\": {\r\n     \"Account\": \"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\r\n     \"Fee\": \"12\",\r\n     \"Flags\": 2148007936,\r\n     \"LastLedgerSequence\": 30865957,\r\n     \"Memos\": [{\r\n       \"Memo\": {\r\n         \"MemoData\": \"726D2D312E322E33\",\r\n         \"MemoType\": \"636C69656E74\"\r\n       }\r\n     }],\r\n     \"Sequence\": 47,\r\n     \"SigningPubKey\": \"03E8BBF8387DCDCE12F8B8F3CAC425D2587548E6510659E27F74E02EC7FE1DAE0E\",\r\n     \"TakerGets\": \"6000000\",\r\n     \"TakerPays\": {\r\n       \"currency\": \"JPY\",\r\n       \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n       \"value\": \"175.2\"\r\n     },\r\n     \"TransactionType\": \"OfferCreate\",\r\n     \"TxnSignature\": \"3044022010F3BB24A47D37FF1F50EC1245DBD345800D03F62FFC1BDCA0F8463CDF8024FA02206E440D5E6A327FA1B126CEF3F2E394DD1DBB7BAFC2B815D061D959C230BAD2F1\",\r\n     \"date\": 552066392,\r\n     \"hash\": \"EEDBE4E68CE7A49F26867949DBD177A4BBDF16CAFFC9519B3BD12FF3B4A2AF63\",\r\n     \"owner_funds\": \"3370983765\"\r\n   },\r\n   \"type\": \"transaction\",\r\n   \"validated\": true\r\n }";
 		testOfferQuality(consumedHalf);
		System.out.println("partially consumed followed by fully consumed");
		testOfferQuality(consumedHalfAndFull1);
		
		testOfferQuality(consumedHalfAndFull1b);
		System.out.println("create order, then fully consumed");
		String consumedFull1 = " {\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"CB63F891823DD0DC7A12484E9D4089997B2E93B7CF6710B733838D6204AA83E2\",\"ledger_index\":30866621,\"meta\":{\"AffectedNodes\":[{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2565023314\",\"Flags\":0,\"OwnerCount\":10,\"Sequence\":5473},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2565023326\",\"OwnerCount\":9,\"Sequence\":5472},\"PreviousTxnID\":\"8AFB17B0CAD09062AF74D1CB85D5071A8161DAE7108505212ED1D1C3F0DCE051\",\"PreviousTxnLgrSeq\":30866590}},{\"CreatedNode\":{\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA3\",\"NewFields\":{\"ExchangeRate\":\"590C2013D5C24EA3\",\"RootIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA3\",\"TakerGetsCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerGetsIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"}}},{\"CreatedNode\":{\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"BC0A867800F99EB9870427801E3C9D4768CC3FED8794B270B17089867FFC3E3E\",\"NewFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"BookDirectory\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA3\",\"OwnerNode\":\"0000000000000018\",\"Sequence\":5472,\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"29.3\"},\"TakerPays\":\"1000000\"}}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"IndexPrevious\":\"0000000000000006\",\"Owner\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"RootIndex\":\"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"D38B8330B1FF06370FEBC6A6DCF8F72A9E03E1E41E613D265C5C531BFE11FD0C\"}}],\"TransactionIndex\":0,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30866623,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5472,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"29.3\"},\"TakerPays\":\"1000000\",\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100E2F111631AA381BF6592236BB6468B91CF54B5ACC22590808FDA72BD65BAD5810220287D1A94BD5DA205CD0394EEDF7CD92F5D2BFCC858F53876A88BC8BC2D024D87\",\"date\":552068652,\"hash\":\"A7BD5F7FA6AAF8B59B290884C9BF0238788B7EA9417B0670B35FAEE8914416C8\",\"owner_funds\":\"24080.98745590657\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		String consumedFull1b = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"9611A85A48447EDD7A3D5DA4EA7D0822C52B56807B112E2D481EE8F5CD4F440E\",\"ledger_index\":30866590,\"meta\":{\"AffectedNodes\":[{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24080.98745590657\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"24110.34605590657\"}},\"PreviousTxnID\":\"33FB02FFFC5A84B9A7EF85F6ED3197608BB06ADCDE887DCF67B13C21511709AC\",\"PreviousTxnLgrSeq\":30866549}},{\"DeletedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"BookDirectory\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA3\",\"BookNode\":\"0000000000000000\",\"Flags\":0,\"OwnerNode\":\"0000000000000018\",\"PreviousTxnID\":\"6CAC54B520507FFE502D023D8BECA5870B6F109AB1B704C20291CBCADB81EC1A\",\"PreviousTxnLgrSeq\":30866587,\"Sequence\":5471,\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"TakerPays\":\"0\"},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"5A2DE4704D2C23D3FCB458809857C6D7EBAA118AC7C1B2C3A63F3BEC22FBBFA9\",\"PreviousFields\":{\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"29.3\"},\"TakerPays\":\"1000000\"}}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2565023326\",\"Flags\":0,\"OwnerCount\":9,\"Sequence\":5472},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2564023326\",\"OwnerCount\":10},\"PreviousTxnID\":\"6CAC54B520507FFE502D023D8BECA5870B6F109AB1B704C20291CBCADB81EC1A\",\"PreviousTxnLgrSeq\":30866587}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"6130.737355877956\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000001BC\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"value\":\"10000000000\"},\"LowNode\":\"0000000000000000\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"9E03D12B7281B41A487F01494BCE1A7099624E50E4FEF5ACE11B2D5BB3C353FB\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"6101.437355877956\"}},\"PreviousTxnID\":\"33FB02FFFC5A84B9A7EF85F6ED3197608BB06ADCDE887DCF67B13C21511709AC\",\"PreviousTxnLgrSeq\":30866549}},{\"DeletedNode\":{\"FinalFields\":{\"ExchangeRate\":\"590C2013D5C24EA3\",\"Flags\":0,\"RootIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA3\",\"TakerGetsCurrency\":\"0000000000000000000000004A50590000000000\",\"TakerGetsIssuer\":\"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\",\"TakerPaysCurrency\":\"0000000000000000000000000000000000000000\",\"TakerPaysIssuer\":\"0000000000000000000000000000000000000000\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"A7A2258942BF79A1C2A55DA88560879DC312966AFDD1CD05590C2013D5C24EA3\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Flags\":0,\"IndexPrevious\":\"0000000000000006\",\"Owner\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"RootIndex\":\"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"},\"LedgerEntryType\":\"DirectoryNode\",\"LedgerIndex\":\"D38B8330B1FF06370FEBC6A6DCF8F72A9E03E1E41E613D265C5C531BFE11FD0C\"}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Balance\":\"3388983657\",\"Flags\":0,\"OwnerCount\":2,\"Sequence\":57},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"E828FC718630DEC1E542D4D2A50074CDB7B3183062FBC59D6E88B63198BF27BF\",\"PreviousFields\":{\"Balance\":\"3389983669\",\"Sequence\":56},\"PreviousTxnID\":\"33FB02FFFC5A84B9A7EF85F6ED3197608BB06ADCDE887DCF67B13C21511709AC\",\"PreviousTxnLgrSeq\":30866549}}],\"TransactionIndex\":7,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"rHMjZANhquizS74FutV3CNoWfQcoVkBxf\",\"Fee\":\"12\",\"Flags\":2148007936,\"LastLedgerSequence\":30866592,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":56,\"SigningPubKey\":\"03E8BBF8387DCDCE12F8B8F3CAC425D2587548E6510659E27F74E02EC7FE1DAE0E\",\"TakerGets\":\"1000000\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"29.3\"},\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"3045022100F538A39FA4525BB74816891FAF850A5FBC9B50327389F47D39837C1B64E338630220447086ECBB53C2D9CB4FD06CB6E09C2C58C18CC514055D56AEAFDC7BA2FE4C83\",\"date\":552068550,\"hash\":\"8AFB17B0CAD09062AF74D1CB85D5071A8161DAE7108505212ED1D1C3F0DCE051\",\"owner_funds\":\"3358983657\"},\"type\":\"transaction\",\"validated\":true}\r\n";
		testOfferQuality(consumedFull1);

		testOfferQuality(consumedFull1b);
	}
	
	/* SUMMARY
	 * Sequence increases when we jave Order Created
	 * Any Final
	 */
	
	private static void testRaw() throws Exception{
		String s =
"{\r\n   \"engine_result\": \"tesSUCCESS\",\r\n   \"engine_result_code\": 0,\r\n   \"engine_result_message\": \"The transaction was applied. Only final in a validated ledger.\",\r\n   \"ledger_hash\": \"CE19CA0188F6B01453E05A8B9FC6AE94FC260B5B5059B513EE2119199FDE9173\",\r\n   \"ledger_index\": 30754741,\r\n   \"meta\": {\r\n     \"AffectedNodes\": [{\r\n       \"CreatedNode\": {\r\n         \"LedgerEntryType\": \"Offer\",\r\n         \"LedgerIndex\": \"60B13F57D2B799D2C05EFB11C7C032D35D9320738AB07C6BDDAC3C10BBCFDFF1\",\r\n         \"NewFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"BookDirectory\": \"7E984AD10069041B9B957C73D05AF2AB3D117C0CCAF7FDA5500AC40B67AED936\",\r\n           \"OwnerNode\": \"000000000000000F\",\r\n           \"Sequence\": 4740,\r\n           \"TakerGets\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"3300\"\r\n           },\r\n           \"TakerPays\": {\r\n             \"currency\": \"RJP\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0.1\"\r\n           }\r\n         }\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"Balance\": \"6060125313\",\r\n           \"Flags\": 0,\r\n           \"OwnerCount\": 10,\r\n           \"Sequence\": 4741\r\n         },\r\n         \"LedgerEntryType\": \"AccountRoot\",\r\n         \"LedgerIndex\": \"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\r\n         \"PreviousFields\": {\r\n           \"Balance\": \"6060125325\",\r\n           \"Sequence\": 4740\r\n         },\r\n         \"PreviousTxnID\": \"58950678AE345C974070D196D73F2244C5F8E90AF7C864D30087AE8F2560E697\",\r\n         \"PreviousTxnLgrSeq\": 30754511\r\n       }\r\n     }, {\r\n       \"CreatedNode\": {\r\n         \"LedgerEntryType\": \"DirectoryNode\",\r\n         \"LedgerIndex\": \"7E984AD10069041B9B957C73D05AF2AB3D117C0CCAF7FDA5500AC40B67AED936\",\r\n         \"NewFields\": {\r\n           \"ExchangeRate\": \"500AC40B67AED936\",\r\n           \"RootIndex\": \"7E984AD10069041B9B957C73D05AF2AB3D117C0CCAF7FDA5500AC40B67AED936\",\r\n           \"TakerGetsCurrency\": \"0000000000000000000000004A50590000000000\",\r\n           \"TakerGetsIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\",\r\n           \"TakerPaysCurrency\": \"000000000000000000000000524A500000000000\",\r\n           \"TakerPaysIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"\r\n         }\r\n       }\r\n     }, {\r\n       \"ModifiedNode\": {\r\n         \"FinalFields\": {\r\n           \"Flags\": 0,\r\n           \"IndexPrevious\": \"0000000000000006\",\r\n           \"Owner\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"RootIndex\": \"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"\r\n         },\r\n         \"LedgerEntryType\": \"DirectoryNode\",\r\n         \"LedgerIndex\": \"91565E4F1A8282718C8D6ED8EFEE2B5DC18101FC76D0AE436F46194F4567EF5E\"\r\n       }\r\n     }, {\r\n       \"DeletedNode\": {\r\n         \"FinalFields\": {\r\n           \"ExchangeRate\": \"590B6C0684F3F000\",\r\n           \"Flags\": 0,\r\n           \"RootIndex\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590B6C0684F3F000\",\r\n           \"TakerGetsCurrency\": \"000000000000000000000000524A500000000000\",\r\n           \"TakerGetsIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\",\r\n           \"TakerPaysCurrency\": \"0000000000000000000000004A50590000000000\",\r\n           \"TakerPaysIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"\r\n         },\r\n         \"LedgerEntryType\": \"DirectoryNode\",\r\n         \"LedgerIndex\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590B6C0684F3F000\"\r\n       }\r\n     }, {\r\n       \"DeletedNode\": {\r\n         \"FinalFields\": {\r\n           \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n           \"BookDirectory\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590B6C0684F3F000\",\r\n           \"BookNode\": \"0000000000000000\",\r\n           \"Flags\": 131072,\r\n           \"OwnerNode\": \"000000000000000F\",\r\n           \"PreviousTxnID\": \"58950678AE345C974070D196D73F2244C5F8E90AF7C864D30087AE8F2560E697\",\r\n           \"PreviousTxnLgrSeq\": 30754511,\r\n           \"Sequence\": 4739,\r\n           \"TakerGets\": {\r\n             \"currency\": \"RJP\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"6642980000000000e-26\"\r\n           },\r\n           \"TakerPays\": {\r\n             \"currency\": \"JPY\",\r\n             \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n             \"value\": \"0.000002135718\"\r\n           }\r\n         },\r\n         \"LedgerEntryType\": \"Offer\",\r\n         \"LedgerIndex\": \"FAE681F5F36A40EC2CB4C47AF50EBCFE646EC786B52C5003E7EC7469BC255475\"\r\n       }\r\n     }],\r\n     \"TransactionIndex\": 87,\r\n     \"TransactionResult\": \"tesSUCCESS\"\r\n   },\r\n   \"status\": \"closed\",\r\n   \"transaction\": {\r\n     \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n     \"Fee\": \"12\",\r\n     \"Flags\": 2147483648,\r\n     \"LastLedgerSequence\": 30754743,\r\n     \"Memos\": [{\r\n       \"Memo\": {\r\n         \"MemoData\": \"726D2D312E322E33\",\r\n         \"MemoType\": \"636C69656E74\"\r\n       }\r\n     }],\r\n     \"Sequence\": 4740,\r\n     \"SigningPubKey\": \"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\r\n     \"TakerGets\": {\r\n       \"currency\": \"JPY\",\r\n       \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n       \"value\": \"3300\"\r\n     },\r\n     \"TakerPays\": {\r\n       \"currency\": \"RJP\",\r\n       \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n       \"value\": \"0.1\"\r\n     },\r\n     \"TransactionType\": \"OfferCreate\",\r\n     \"TxnSignature\": \"30440220101ABC9FB31CFAC747C5B9833341C4832A194C2C57C3A8060E1D9EB2CD6938240220029CF0AB692146431AAB7B8766FD236DEF1D31945F689403917ECF2546B8430A\",\r\n     \"date\": 551676281,\r\n     \"hash\": \"9A5A9ECA97CD3F3E028F3BC663E336F7643A4A58749AD2A63D4399EE37175C1D\",\r\n     \"owner_funds\": \"9999.86990579025\"\r\n   },\r\n   \"type\": \"transaction\",\r\n   \"validated\": true\r\n }";

		String EF7BF9F523E74777027EE4765F542532FF89B6E1132685D6E75C4AFFF072151C  = "{\r\n  \"engine_result\": \"tesSUCCESS\",\r\n  \"engine_result_code\": 0,\r\n  \"engine_result_message\": \"The transaction was applied. Only final in a validated ledger.\",\r\n  \"ledger_hash\": \"1942CA83566B16802700FB537BAE8ED13EB9A6C5E79EF8072F633C3FF0076AFF\",\r\n  \"ledger_index\": 30752350,\r\n  \"meta\": {\r\n    \"AffectedNodes\": [{\r\n        \"ModifiedNode\": {\r\n          \"FinalFields\": {\r\n            \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n            \"Balance\": \"6060125289\",\r\n            \"Flags\": 0,\r\n            \"OwnerCount\": 9,\r\n            \"Sequence\": 4743\r\n          },\r\n          \"LedgerEntryType\": \"AccountRoot\",\r\n          \"LedgerIndex\": \"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\r\n          \"PreviousFields\": {\r\n            \"Balance\": \"6060125301\",\r\n            \"OwnerCount\": 10,\r\n            \"Sequence\": 4742\r\n          },\r\n          \"PreviousTxnID\": \"503DD0C7597051A4592E8DABC2BA4AA286231FFE3A30AB855D9A569CCB887132\",\r\n          \"PreviousTxnLgrSeq\": 30756200\r\n        }\r\n      },\r\n      {\r\n        \"DeletedNode\": {\r\n          \"FinalFields\": {\r\n            \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n            \"BookDirectory\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590BACC80FA93000\",\r\n            \"BookNode\": \"0000000000000000\",\r\n            \"Flags\": 131072,\r\n            \"OwnerNode\": \"000000000000000F\",\r\n            \"PreviousTxnID\": \"503DD0C7597051A4592E8DABC2BA4AA286231FFE3A30AB855D9A569CCB887132\",\r\n            \"PreviousTxnLgrSeq\": 30756200,\r\n            \"Sequence\": 4741,\r\n            \"TakerGets\": {\r\n              \"currency\": \"RJP\",\r\n              \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n              \"value\": \"0.1\"\r\n            },\r\n            \"TakerPays\": {\r\n              \"currency\": \"JPY\",\r\n              \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n              \"value\": \"3286.2\"\r\n            }\r\n          },\r\n          \"LedgerEntryType\": \"Offer\",\r\n          \"LedgerIndex\": \"76BEC8D4790AC90F0C9FCECFCBE9DC6969AD2866114362AE4AA2B0382F785B29\"\r\n        }\r\n      },\r\n      {\r\n        \"ModifiedNode\": {\r\n          \"FinalFields\": {\r\n            \"Flags\": 0,\r\n            \"IndexPrevious\": \"0000000000000006\",\r\n            \"Owner\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n            \"RootIndex\": \"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"\r\n          },\r\n          \"LedgerEntryType\": \"DirectoryNode\",\r\n          \"LedgerIndex\": \"91565E4F1A8282718C8D6ED8EFEE2B5DC18101FC76D0AE436F46194F4567EF5E\"\r\n        }\r\n      },\r\n      {\r\n        \"DeletedNode\": {\r\n          \"FinalFields\": {\r\n            \"ExchangeRate\": \"590BACC80FA93000\",\r\n            \"Flags\": 0,\r\n            \"RootIndex\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590BACC80FA93000\",\r\n            \"TakerGetsCurrency\": \"000000000000000000000000524A500000000000\",\r\n            \"TakerGetsIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\",\r\n            \"TakerPaysCurrency\": \"0000000000000000000000004A50590000000000\",\r\n            \"TakerPaysIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"\r\n          },\r\n          \"LedgerEntryType\": \"DirectoryNode\",\r\n          \"LedgerIndex\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590BACC80FA93000\"\r\n        }\r\n      }\r\n    ],\r\n    \"TransactionIndex\": 0,\r\n    \"TransactionResult\": \"tesSUCCESS\"\r\n  },\r\n  \"status\": \"closed\",\r\n  \"transaction\": {\r\n    \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n    \"Fee\": \"12\",\r\n    \"Flags\": 2147483648,\r\n    \"LastLedgerSequence\": 30752352,\r\n    \"Memos\": [{\r\n      \"Memo\": {\r\n        \"MemoData\": \"726D2D312E322E33\",\r\n        \"MemoType\": \"636C69656E74\"\r\n      }\r\n    }],\r\n    \"Sequence\": 4734,\r\n    \"SigningPubKey\": \"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\r\n    \"TakerGets\": {\r\n      \"currency\": \"JPY\",\r\n      \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n      \"value\": \"159.25\"\r\n    },\r\n    \"TakerPays\": \"5000000\",\r\n    \"TransactionType\": \"OfferCreate\",\r\n    \"TxnSignature\": \"3044022032523881EED58446104B57C17EBF71D8125D7702DC054BA6B3EFDD8CA1755AF7022013A240D77602E319F67ED6B7AA7868A8E986586E1DF015833C829223EBA6A81C\",\r\n    \"date\": 551667961,\r\n    \"hash\": \"8E943C78B4783AF66571EC86331DC8C4444DD34A24A4A9D24748F633AE71ED5F\",\r\n    \"owner_funds\": \"7727.279530849417\"\r\n  },\r\n  \"type\": \"transaction\",\r\n  \"validated\": true\r\n}";
		
		String z = "{\r\n  \"engine_result\": \"tesSUCCESS\",\r\n  \"engine_result_code\": 0,\r\n  \"engine_result_message\": \"The transaction was applied. Only final in a validated ledger.\",\r\n  \"ledger_hash\": \"9193A88F249093A33D0DA5603A4762B1C4E4F8611BF8BBF091E1BC99CC19A79E\",\r\n  \"ledger_index\": 30764869,\r\n  \"meta\": {\r\n    \"AffectedNodes\": [{\r\n      \"DeletedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n          \"BookDirectory\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590B51A66E412000\",\r\n          \"BookNode\": \"0000000000000000\",\r\n          \"Flags\": 131072,\r\n          \"OwnerNode\": \"000000000000000F\",\r\n          \"PreviousTxnID\": \"326DCCB5373A3D588E1870F3840CB4B3B62988D1C667389D9B63F6EE0E990A29\",\r\n          \"PreviousTxnLgrSeq\": 30764849,\r\n          \"Sequence\": 4758,\r\n          \"TakerGets\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"TakerPays\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          }\r\n        },\r\n        \"LedgerEntryType\": \"Offer\",\r\n        \"LedgerIndex\": \"121E7C39F62C053F0D66496A086573EA84DAFF022F3CC033998656B12D384C4C\",\r\n        \"PreviousFields\": {\r\n          \"TakerGets\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0.09652923889012509\"\r\n          },\r\n          \"TakerPays\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"3075.421551039386\"\r\n          }\r\n        }\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"10526.38159339581\"\r\n          },\r\n          \"Flags\": 1114112,\r\n          \"HighLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"HighNode\": \"0000000000000399\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n            \"value\": \"100000\"\r\n          },\r\n          \"LowNode\": \"0000000000000001\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"7450.96004235643\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"326DCCB5373A3D588E1870F3840CB4B3B62988D1C667389D9B63F6EE0E990A29\",\r\n        \"PreviousTxnLgrSeq\": 30764849\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"4.875721472777413\"\r\n          },\r\n          \"Flags\": 1114112,\r\n          \"HighLimit\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"HighNode\": \"00000000000003FB\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n            \"value\": \"10000\"\r\n          },\r\n          \"LowNode\": \"0000000000000006\",\r\n          \"LowQualityIn\": 1000000000\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"4A8FE98984B510E3F0223CB8C9110FA370EC545BCD6CE6863C8405E5BC360423\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"4.972443770145318\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"326DCCB5373A3D588E1870F3840CB4B3B62988D1C667389D9B63F6EE0E990A29\",\r\n        \"PreviousTxnLgrSeq\": 30764849\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n          \"Balance\": \"6061125097\",\r\n          \"Flags\": 0,\r\n          \"OwnerCount\": 9,\r\n          \"Sequence\": 4759\r\n        },\r\n        \"LedgerEntryType\": \"AccountRoot\",\r\n        \"LedgerIndex\": \"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\r\n        \"PreviousFields\": {\r\n          \"OwnerCount\": 10\r\n        },\r\n        \"PreviousTxnID\": \"326DCCB5373A3D588E1870F3840CB4B3B62988D1C667389D9B63F6EE0E990A29\",\r\n        \"PreviousTxnLgrSeq\": 30764849\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"0.09652923889012509\"\r\n          },\r\n          \"Flags\": 1114112,\r\n          \"HighLimit\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"HighNode\": \"0000000000000338\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rsPrWzpYp5jj278vHVgp1tMvbKdHAZGFbi\",\r\n            \"value\": \"1000000000\"\r\n          },\r\n          \"LowNode\": \"0000000000000001\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"7BE65D79F3087B4870A4E8596F1533D9761D53C05B0C51C1DEB5B0DA6A58C27C\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"RJP\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"0\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"B97E75D1336FA0455F3090A6653330879684420C50EBA3E4A34FE49E6C245095\",\r\n        \"PreviousTxnLgrSeq\": 30572935\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Account\": \"rsPrWzpYp5jj278vHVgp1tMvbKdHAZGFbi\",\r\n          \"Balance\": \"13973364092\",\r\n          \"Flags\": 0,\r\n          \"OwnerCount\": 37,\r\n          \"Sequence\": 6864595\r\n        },\r\n        \"LedgerEntryType\": \"AccountRoot\",\r\n        \"LedgerIndex\": \"8881335E10619D1D17D4EB1FEF2647C232C892D377D9A34998C361FFFC9C4CCC\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": \"13973389092\",\r\n          \"Sequence\": 6864594\r\n        },\r\n        \"PreviousTxnID\": \"E7A9F315481A83F3CCE308298D0DEEC5A8AFEB3BE347E3046BFDFE0FB69DAF9A\",\r\n        \"PreviousTxnLgrSeq\": 30764869\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Flags\": 0,\r\n          \"IndexPrevious\": \"0000000000000006\",\r\n          \"Owner\": \"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\r\n          \"RootIndex\": \"C5383B94DDE4BE2A184757D80837080C4D1EAB80789FE39F7D7AECFB0D0304BB\"\r\n        },\r\n        \"LedgerEntryType\": \"DirectoryNode\",\r\n        \"LedgerIndex\": \"91565E4F1A8282718C8D6ED8EFEE2B5DC18101FC76D0AE436F46194F4567EF5E\"\r\n      }\r\n    }, {\r\n      \"ModifiedNode\": {\r\n        \"FinalFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"656.124172136904\"\r\n          },\r\n          \"Flags\": 1114112,\r\n          \"HighLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n            \"value\": \"0\"\r\n          },\r\n          \"HighNode\": \"0000000000000232\",\r\n          \"LowLimit\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rsPrWzpYp5jj278vHVgp1tMvbKdHAZGFbi\",\r\n            \"value\": \"1000000000\"\r\n          },\r\n          \"LowNode\": \"0000000000000000\"\r\n        },\r\n        \"LedgerEntryType\": \"RippleState\",\r\n        \"LedgerIndex\": \"ADCD69C9DAFD1076DA7075D0E53667CB67EDD58675BD653162A7EA483E392851\",\r\n        \"PreviousFields\": {\r\n          \"Balance\": {\r\n            \"currency\": \"JPY\",\r\n            \"issuer\": \"rrrrrrrrrrrrrrrrrrrrBZbvji\",\r\n            \"value\": \"3737.696566278369\"\r\n          }\r\n        },\r\n        \"PreviousTxnID\": \"7504557145245B931556B275388001423ACFA2EC886D8C5253B7D565550B2A4A\",\r\n        \"PreviousTxnLgrSeq\": 30764868\r\n      }\r\n    }, {\r\n      \"DeletedNode\": {\r\n        \"FinalFields\": {\r\n          \"ExchangeRate\": \"590B51A66E412000\",\r\n          \"Flags\": 0,\r\n          \"RootIndex\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590B51A66E412000\",\r\n          \"TakerGetsCurrency\": \"000000000000000000000000524A500000000000\",\r\n          \"TakerGetsIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\",\r\n          \"TakerPaysCurrency\": \"0000000000000000000000004A50590000000000\",\r\n          \"TakerPaysIssuer\": \"6F2531F2B8CDB96D6D986D9D75CC0156DF2C5387\"\r\n        },\r\n        \"LedgerEntryType\": \"DirectoryNode\",\r\n        \"LedgerIndex\": \"DCAAC0CDAC8DA851AC8E225CA9ED9305CB4BBE7E4E255AB3590B51A66E412000\"\r\n      }\r\n    }],\r\n    \"TransactionIndex\": 7,\r\n    \"TransactionResult\": \"tesSUCCESS\"\r\n  },\r\n  \"status\": \"closed\",\r\n  \"transaction\": {\r\n    \"Account\": \"rsPrWzpYp5jj278vHVgp1tMvbKdHAZGFbi\",\r\n    \"Fee\": \"25000\",\r\n    \"Flags\": 131072,\r\n    \"LastLedgerSequence\": 30764871,\r\n    \"Sequence\": 6864594,\r\n    \"SigningPubKey\": \"031161F2602A6746CA817D3EE4419F29641690CD613B015B923A2B8146BDEA7028\",\r\n    \"TakerGets\": {\r\n      \"currency\": \"JPY\",\r\n      \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n      \"value\": \"37391.9164490488\"\r\n    },\r\n    \"TakerPays\": {\r\n      \"currency\": \"RJP\",\r\n      \"issuer\": \"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\r\n      \"value\": \"1.173162764054729\"\r\n    },\r\n    \"TransactionType\": \"OfferCreate\",\r\n    \"TxnSignature\": \"304502210081DFD7601B57813543FEF52F83818492704794D4E4C025C3CBF45CF63D8E741502206964B15D3D5912E284BC85D9ECD52600B6A3DA544D91A8A53E69360D472C4C42\",\r\n    \"date\": 551710353,\r\n    \"hash\": \"47B4F8DD0DE3D49AA47196C1CE6DB50231B90EA34A7D720F3AAE9CCE956624E9\",\r\n    \"owner_funds\": \"656.124172136904\"\r\n  },\r\n  \"type\": \"transaction\",\r\n  \"validated\": true\r\n}";
		
		
		
		
		
	}
	
	public static void testOfferQuality(String raw) throws Exception {
		System.out.println("\n");
		System.out.println("\n");
		System.out.println("****NEW TX****");
		
		
		JSONObject transaction = new JSONObject(raw);
		JSONObject metaJSON = (JSONObject) transaction.remove("meta");
		TransactionMeta meta = (TransactionMeta) STObject.fromJSONObject(metaJSON);
		Transaction txn = (Transaction) STObject.fromJSONObject(transaction.getJSONObject("transaction"));

		if (txn.get(Field.TransactionType).toString().equals("OfferCrate")) {
			Amount gets = txn.get(Amount.TakerGets);
			Amount pays = txn.get(Amount.TakerPays);

			System.out.println("---------------------------------------------------------------");
			System.out.println("OfferCreate ");
			System.out.println("---------------------------------------------------------------");
			System.out.println("Get/Pay:    " + gets.currencyString() + "/" + pays.currencyString());
			System.out.println("Bid:        " + gets.computeQuality(pays));
			System.out.println("TakerPays:  " + pays);
			System.out.println("TakerGets:  " + gets);
		} else if (txn.get(Field.TransactionType).toString().equals("OfferCancel")) {
			System.out.println("---------------------------------------------------------------");
			System.out.println("OfferCancel ");
			System.out.println("---------------------------------------------------------------");
		} else if (txn.get(Field.TransactionType).toString().equals("Payment")) {
			System.out.println("---------------------------------------------------------------");
			System.out.println("Payment ");
			System.out.println("---------------------------------------------------------------");

		} else {
			System.out.println("---------------------------------------------------------------");
			System.out.println(txn.get(Field.TransactionType).toString());
			System.out.println("---------------------------------------------------------------");
		}

		System.out.println(txn.prettyJSON());
		ArrayList<AffectedNode> deletedNodes = new ArrayList<>();
		ArrayList<Offer> offersExecuted = new ArrayList<>();

		for (AffectedNode node : meta.affectedNodes()) {
			
			if (!node.isCreatedNode()) {
				// Merge fields from node / node.FinalFields && node.PreviousFields
				// to determine state of node prior to transaction.
				// Any fields that were in PreviousFields will  have their final
				// values
				// in a nested STObject keyed by FinalFields.
				LedgerEntry asPrevious = (LedgerEntry) node.nodeAsPrevious();
				// If it's an offer
				if(node.isDeletedNode()){
					deletedNodes.add(node);
				}
				if (asPrevious instanceof Offer) {
					// We can down-cast this to use Offer specific methods
					offersExecuted.add((Offer) asPrevious);
				}
			} else {
				LedgerEntry asFinal = (LedgerEntry) node.nodeAsPrevious();
				if (asFinal instanceof Offer) {
					Offer offer = (Offer) asFinal;						
					System.out.println("---------------------------------------------------------------");
					System.out.println("Offer Created");
					System.out.println("---------------------------------------------------------------");
					System.out.println("Get/Pay:    " + offer.getPayCurrencyPair());
					System.out.println("Bid:        " + offer.bidQuality());
					System.out.println("TakerPays:  " + offer.takerPays());
					System.out.println("TakerGets:  " + offer.takerGets());
					System.out.println("---------------------------------------------------------------");
					System.out.println(offer.prettyJSON());
				}
			}
		}
		
		deletedNodes.forEach(dn -> {
			LedgerEntry le = (LedgerEntry) dn.nodeAsFinal();
			STObject finalFields = dn.get(STObject.FinalFields);
			
			Hash256 previousTxnId = le.get(Hash256.PreviousTxnID);
			if (previousTxnId != null){
				System.out.println(previousTxnId.toString());

			}
		});

		Collections.sort(offersExecuted, Offer.qualityAscending);
		for (Offer offer : offersExecuted) {
			STObject finalFields = offer.get(STObject.FinalFields);
			if (finalFields == null) {
				System.out.println("FinalFields is null");
//				System.out.println(offer.prettyJSON());

			} else {
				
				STObject executed = offer.executed(offer.get(STObject.FinalFields));
				// This will be computed from the BookDirectory field
				System.out.println("---------------------------------------------------------------");
				System.out.println("Offer Executed");
				System.out.println("---------------------------------------------------------------");
				System.out.println("Get/Pay: " + offer.getPayCurrencyPair());
				System.out.println("Ask:     " + offer.directoryAskQuality().stripTrailingZeros().toPlainString());
				System.out.println("Paid:    " + executed.get(Amount.TakerPays));
				System.out.println("Got:     " + executed.get(Amount.TakerGets));
				System.out.println("---------------------------------------------------------------");
				System.out.println(offer.prettyJSON());
			}

		}
		System.out.println("****END TX****");
		System.out.println("\n");
		System.out.println("\n");


}
	
}
