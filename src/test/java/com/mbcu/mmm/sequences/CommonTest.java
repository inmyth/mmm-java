package com.mbcu.mmm.sequences;

import static org.junit.Assert.assertEquals;

import org.junit.Test;

import com.mbcu.mmm.models.internal.Config;

public class CommonTest {
	private static final String configPath = "config.txt";
	
	
	@Test
	public void autoBridge() throws Exception{
		Common c = Common.newInstance( Config.build(configPath));
		System.out.println("Autobridge with single element majority");
		String oneToOne = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"DE54C3757678AC1A4153B1357D0DE94264BC5F167183B7FE5625967ABC0DBCD0\",\"ledger_index\":30927336,\"meta\":{\"AffectedNodes\":[{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"BookDirectory\":\"7035F45D0D6677B54720F2A9CBD0EA1155313D0F038A9E5B5D2184238194439F\",\"BookNode\":\"0000000000000000\",\"Flags\":0,\"OwnerNode\":\"0000000000000012\",\"Sequence\":664,\"TakerGets\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"3.07\"},\"TakerPays\":\"2896226416\"},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"0ED3CD935ABB3FCA15ABB71796A9EE33B63E8ACC921FBA43156F1A592D825460\",\"PreviousFields\":{\"TakerGets\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"3.08\"},\"TakerPays\":\"2905660378\"},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"20556.88790576798\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"20817.34172866395\"}},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"4.588899891940538\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000003FB\",\"LowLimit\":{\"currency\":\"RJP\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"10000\"},\"LowNode\":\"0000000000000006\",\"LowQualityIn\":1000000000},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"4A8FE98984B510E3F0223CB8C9110FA370EC545BCD6CE6863C8405E5BC360423\",\"PreviousFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"4.578899891940538\"}},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D5009C9EE45BFE7F4\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000000019\",\"Sequence\":909,\"TakerGets\":\"781748105\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"21539.50551443824\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"5D9EDF20A4EC58656E020967B33B101748257E88F4A2A7A33335926340A7853F\",\"PreviousFields\":{\"TakerGets\":\"791182067\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"21799.43946942423\"}},\"PreviousTxnID\":\"E2DE3F155C66C415C9DFBDB7000AB71D74E8AB6FEA4339CB514E90B879C0C87D\",\"PreviousTxnLgrSeq\":30927186}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2592222282\",\"Flags\":0,\"OwnerCount\":9,\"Sequence\":5514},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2592222294\",\"Sequence\":5513},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-109.6213379762039\"},\"Flags\":2228224,\"HighLimit\":{\"currency\":\"RJP\",\"issuer\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"value\":\"10000\"},\"HighNode\":\"0000000000000000\",\"HighQualityIn\":1000000000,\"LowLimit\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"LowNode\":\"0000000000000324\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"C0ADFF611CD723F588F6E274696526AD6E3E3061D43B92C2761A7EDB64967999\",\"PreviousFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-109.6313579762039\"}},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-12470320.02357659\"},\"Flags\":2228224,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"value\":\"50000000\"},\"HighNode\":\"0000000000000000\",\"HighQualityIn\":1000000000,\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"LowNode\":\"0000000000000323\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"D727CD2D19774BA754A358FDFD2744A7563BB99ED4F0E9979A1B3565758D9A17\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-12470060.08962161\"}},\"PreviousTxnID\":\"E2DE3F155C66C415C9DFBDB7000AB71D74E8AB6FEA4339CB514E90B879C0C87D\",\"PreviousTxnLgrSeq\":30927186}}],\"TransactionIndex\":5,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30927338,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5513,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"260\"},\"TakerPays\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0.01\"},\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"304402201AB0A4BF8960D69699D8D253B2B361C31CD8F632F22EE2F8C2CB2F85E678CF22022068C9987BFE0023DF2B4E39608114A26F84F258435911383A1468AF66A405A507\",\"date\":552282502,\"hash\":\"9D499203719FF6F6D5750198066DF7F0B68AD50DF6A5CF93190D658BE077F36B\",\"owner_funds\":\"20556.88790576798\"},\"type\":\"transaction\",\"validated\":true}\n";
		c.filterTx(oneToOne);
		System.out.println("Autobridge with single element majority");
		String oneToOneReversed = "{\"engine_result\":\"tesSUCCESS\",\"engine_result_code\":0,\"engine_result_message\":\"The transaction was applied. Only final in a validated ledger.\",\"ledger_hash\":\"DE54C3757678AC1A4153B1357D0DE94264BC5F167183B7FE5625967ABC0DBCD0\",\"ledger_index\":30927336,\"meta\":{\"AffectedNodes\":[{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"BookDirectory\":\"7035F45D0D6677B54720F2A9CBD0EA1155313D0F038A9E5B5D2184238194439F\",\"BookNode\":\"0000000000000000\",\"Flags\":0,\"OwnerNode\":\"0000000000000012\",\"Sequence\":664,\"TakerGets\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"3.07\"},\"TakerPays\":\"2896226416\"},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"0ED3CD935ABB3FCA15ABB71796A9EE33B63E8ACC921FBA43156F1A592D825460\",\"PreviousFields\":{\"TakerGets\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"3.08\"},\"TakerPays\":\"2905660378\"},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"20556.88790576798\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"0000000000000399\",\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"100000\"},\"LowNode\":\"0000000000000001\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"21110D01A36A7EB20188B11D685B847322DE631145C31803E1760550FA399BAD\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"20817.34172866395\"}},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"4.588899891940538\"},\"Flags\":1114112,\"HighLimit\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"HighNode\":\"00000000000003FB\",\"LowLimit\":{\"currency\":\"RJP\",\"issuer\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"value\":\"10000\"},\"LowNode\":\"0000000000000006\",\"LowQualityIn\":1000000000},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"4A8FE98984B510E3F0223CB8C9110FA370EC545BCD6CE6863C8405E5BC360423\",\"PreviousFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"4.578899891940538\"}},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"BookDirectory\":\"11EEBF7DFC0076D299322039F1493C921CAAEFE85B322E5D5009C9EE45BFE7F4\",\"BookNode\":\"0000000000000000\",\"Flags\":131072,\"OwnerNode\":\"0000000000000019\",\"Sequence\":909,\"TakerGets\":\"781748105\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"21539.50551443824\"}},\"LedgerEntryType\":\"Offer\",\"LedgerIndex\":\"5D9EDF20A4EC58656E020967B33B101748257E88F4A2A7A33335926340A7853F\",\"PreviousFields\":{\"TakerGets\":\"791182067\",\"TakerPays\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"21799.43946942423\"}},\"PreviousTxnID\":\"E2DE3F155C66C415C9DFBDB7000AB71D74E8AB6FEA4339CB514E90B879C0C87D\",\"PreviousTxnLgrSeq\":30927186}},{\"ModifiedNode\":{\"FinalFields\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Balance\":\"2592222282\",\"Flags\":0,\"OwnerCount\":9,\"Sequence\":5514},\"LedgerEntryType\":\"AccountRoot\",\"LedgerIndex\":\"72A59CDF8FFBF65C20D01D3A3D5DA5BAE3158A3881E7AEE525A01B1CC73D32DD\",\"PreviousFields\":{\"Balance\":\"2592222294\",\"Sequence\":5513},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-109.6213379762039\"},\"Flags\":2228224,\"HighLimit\":{\"currency\":\"RJP\",\"issuer\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"value\":\"10000\"},\"HighNode\":\"0000000000000000\",\"HighQualityIn\":1000000000,\"LowLimit\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"LowNode\":\"0000000000000324\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"C0ADFF611CD723F588F6E274696526AD6E3E3061D43B92C2761A7EDB64967999\",\"PreviousFields\":{\"Balance\":{\"currency\":\"RJP\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-109.6313579762039\"}},\"PreviousTxnID\":\"67EB60F07CAC3F4EE4C57DAA432E830080423A25B49AEA7A03B54875A2F7F02E\",\"PreviousTxnLgrSeq\":30927130}},{\"ModifiedNode\":{\"FinalFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-12470320.02357659\"},\"Flags\":2228224,\"HighLimit\":{\"currency\":\"JPY\",\"issuer\":\"rKLPBY3nEhETSThEfWRaHNBH1Rxeo57UGn\",\"value\":\"50000000\"},\"HighNode\":\"0000000000000000\",\"HighQualityIn\":1000000000,\"LowLimit\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0\"},\"LowNode\":\"0000000000000323\"},\"LedgerEntryType\":\"RippleState\",\"LedgerIndex\":\"D727CD2D19774BA754A358FDFD2744A7563BB99ED4F0E9979A1B3565758D9A17\",\"PreviousFields\":{\"Balance\":{\"currency\":\"JPY\",\"issuer\":\"rrrrrrrrrrrrrrrrrrrrBZbvji\",\"value\":\"-12470060.08962161\"}},\"PreviousTxnID\":\"E2DE3F155C66C415C9DFBDB7000AB71D74E8AB6FEA4339CB514E90B879C0C87D\",\"PreviousTxnLgrSeq\":30927186}}],\"TransactionIndex\":5,\"TransactionResult\":\"tesSUCCESS\"},\"status\":\"closed\",\"transaction\":{\"Account\":\"raNDu1gNyZ5hipBTKxm5zx7NovA1rNnNRf\",\"Fee\":\"12\",\"Flags\":2147483648,\"LastLedgerSequence\":30927338,\"Memos\":[{\"Memo\":{\"MemoData\":\"726D2D312E322E33\",\"MemoType\":\"636C69656E74\"}}],\"Sequence\":5513,\"SigningPubKey\":\"02E2F1208D1715E18B0957FC819546FA7434B4A19EE38321932D2ED28FA090678E\",\"TakerGets\":{\"currency\":\"JPY\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"260\"},\"TakerPays\":{\"currency\":\"RJP\",\"issuer\":\"rB3gZey7VWHYRqJHLoHDEJXJ2pEPNieKiS\",\"value\":\"0.01\"},\"TransactionType\":\"OfferCreate\",\"TxnSignature\":\"304402201AB0A4BF8960D69699D8D253B2B361C31CD8F632F22EE2F8C2CB2F85E678CF22022068C9987BFE0023DF2B4E39608114A26F84F258435911383A1468AF66A405A507\",\"date\":552282502,\"hash\":\"9D499203719FF6F6D5750198066DF7F0B68AD50DF6A5CF93190D658BE077F36B\",\"owner_funds\":\"20556.88790576798\"},\"type\":\"transaction\",\"validated\":true}\n";
		c.filterTx(oneToOneReversed);
	}

}
